"""
????? ??? ???????????? ????????? ???????? ?????????
"""

import pytest
from seditor.terminal.manager import TerminalManager
from seditor.core.app import App


def test_terminal_manager_has_size_changed():
    """???? ???????? ????????? ???????? ?????????"""
    tm = TerminalManager()
    initial_width = tm.width
    initial_height = tm.height
    
    # ????? ????? ????????????? ??????? ?? ?????? ??????????
    assert tm.has_size_changed() is False
    
    # ????????? ??????? ??????? ??? ????????? ?????????
    tm.refresh_size()
    # ????? refresh_size ??????? ?? ?????? ????????? ???????????
    assert tm.has_size_changed() is False


def test_app_refresh_updates_layout():
    """???? ?????????? layout ??? ?????? refresh"""
    app = App()
    initial_tree_width = app.layout.tree_width
    initial_editor_width = app.layout.editor_width
    
    # ?????????? ????????? ??????? ?????????
    # ? ????? ?? ?????? ?????????, ??? ????? refresh ?????????? ? ????????
    app.refresh()
    
    # ????? refresh ??????? ?????? ???? ?????????
    assert app.layout.tree_width >= 0
    assert app.layout.editor_width >= 0
    # ??????? ????? ???????? ???? ??, ??? ? ?? refresh


def test_app_has_resize_detection():
    """???? ??????? ?????? ???????? ????????? ???????? ? App"""
    app = App()
    
    # ?????????, ??? ????????-???????? ????? ????? has_size_changed
    assert hasattr(app.term_manager, 'has_size_changed')
    
    # ?????????, ??? ????? ?????????? ??? ??????
    result = app.term_manager.has_size_changed()
    assert isinstance(result, bool)
